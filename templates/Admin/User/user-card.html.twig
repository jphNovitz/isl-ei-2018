{% extends '_bases/_admin_base.html.twig' %}

{% block body %}
    <div class="ui stackable grid">

        <div class="sixteen wide column ui center aligned">
            <h1 class="ui center aligned icon green header">
                <div class="content">
                    {{ user.username }}
                    <div class="sub header">
                        {% block sub_header %}
                            {{ user.email }}
                        {% endblock %}
                    </div>
                </div>
            </h1>

            <div class="ui  horizontal  aligned list ">
                {% block header_buttons %}    {% endblock %}
                <div class="item">
                </div>
                {#<div class="item"><a href="{{ path(user|entity ~ '_delete', {'slug' : user.slug}) }}"#}
                                     {#class="ui  basic secondary circular button" style="min-width: 7rem"> supprimer</a>#}
                </div>
            </div>
        </div>
<div class="ui grid" id="global">

    <div class="one wide column center aligned ">
    </div>
        <div class="fourteen wide column center aligned ui grid">
            <div class="six wide column ui raised segment left aligned user-infos">
                <p>Nom: {{ user.lastName }}
                <br />Prenom: {{ user.lastName }}
                    <br/><em>Nom d'utilisateur: <strong>{{ user.username }}</strong>
                        <br /><em>Email: </em>   {{ user.email }}
                        <br/>Id: {{ user.id }}</em>
                    {% block infos %}
                        <p>
                            Actif: {{ user.isActive ? '<i class="ui green horizontal label"> oui</i>' : '<i class="ui red horizontal label"> non </i>' }}
                        </p>
                    {% endblock %}
                </p>
            </div>
            <div class="nine wide column left aligned">
                {% block card_rest %}
                <div class="ui list">
                    {% for order in orders %}
                        <div class="item">
                            {{ order.created |date()}}
                            {{ order.done ? '<i class="ui green horizontal label"> classé</i>' : '<i class="ui red horizontal label"> En cours </i>' }}
                            <i class="ui caret icon" :class="detailClass({{ order.id }})"  style="display: inline-flex" @click="toggleDetail({{ order.id }})"></i>
                            {#<button @click="toggleDetail()">ddd</button>#}
                            <div class="content" v-if="detailClass({{ order.id }}) === 'down' ">
                                {% for item in order.items %}
                                <table class="ui celled table">
                                    <thead>
                                    <tr>
                                        <th>Produit</th>
                                        <th>Pain</th>
                                        <th>Crudites</th>
                                        <th>halal</th>
                                        <th>prix</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>{{ item.product.name }}</td>
                                        <td>
                                            {% if item.bread is not empty %}
                                                {{ item.bread }}
                                            {% else %}
                                                ~
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if item.vegetables|length > 0 %}
                                                {% for vegetable in item.vegetables %}
                                                    {{ vegetable.name }}
                                                {% endfor %}
                                            {%  else %}
                                                ~
                                            {% endif %}
                                        </td>
                                        <td>
                                            {{ item.halal ? '<i class="ui olive horizontal label"> Halal</i>' : 'non'}}
                                        </td>
                                        <td>{{ item.price }}</td>
                                    </tr>
                                 </tbody>
                                </table>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
                {% endblock %}
            </div>
        </div>
        <div class="one wide column center aligned">
            <div class="action" id="action">
                <div :class="menuActive">
                {% if user.isActive %}
                    <button class="ui  circular icon button" title="Désactiver"><i class="user times icon"></i></button>
                {% else %}
                    <button class="ui  circular icon button" title="Activer"><i class="user icon"></i></button>
                {% endif %}
                <button class="ui negative circular icon button" title="Supprimer"><i class="trash icon"></i></button>
                </div>
                <button id="menu" class="ui orange circular icon button" @click="showMenu" title="Menu"><i class="plus icon"></i></button>

        </div>
    </div>
    </div>

{% endblock %}
{% block javascripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.18/vue.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    {#<script src="{{ asset('build/js/vue.js') }}"> </script>#}
<script>

    Vue.config.delimiters= ['${', '}'];
        const action = new Vue({
            el: '#action',
            data(){
                return {
                    menuActive: 'notVisible',
                    detailed: []
                }
            },
            created(){
           },
            methods:{
                showMenu: function(){
                    if (this.menuActive === 'notVisible' ){
                        this.menuActive = 'visible'
                    } else {
                        this.menuActive = 'notVisible'
                    }
                },
                toggleDetail: function (id) {
                    alert()
                    let i = this.detailed.indexOf(id);
                    if ( i > 0){
                        this.detailed.splice(i, 1)
                    } else {
                        this.detailed.push(id) ;
                    }
                    console.log(this.detailed)
                },
                detailClass: function (id) {
                    if (this.detailed.indexOf(id) > -1 ){
                        return 'down' ;
                    } else {
                        return 'right' ;
                    }

                }
            }
        })
        const global = new Vue({
            el: '#global',
            data(){
                return {
                    menuActive: 'notVisible',
                    detailed: []
                }
            },
            created(){
           },
            methods:{
                showMenu: function(){
                    if (this.menuActive === 'notVisible' ){
                        this.menuActive = 'visible'
                    } else {
                        this.menuActive = 'notVisible'
                    }
                },
                toggleDetail: function (id) {
                    let i = this.detailed.indexOf(id);
                    if ( i > -1){
                        this.detailed.splice(i, 1)
                    } else {
                        this.detailed.push(id) ;
                    }
                    console.log(this.detailed)
                },
                detailClass: function (id) {
                    if (this.detailed.indexOf(id) > -1 ){
                        return 'down' ;
                    } else {
                        return 'right' ;
                    }

                }
            }
        })
</script>

{% endblock %}